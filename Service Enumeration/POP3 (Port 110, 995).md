# POP3 (Port 110, 995)

## Connect

### Netcat

Kết nối tới máy chủ POP3 qua cổng 110 để tương tác trực tiếp:

```
nc <ip> 110
```

### OpenSSL

Kiểm tra kết nối POP3 an toàn qua cổng 995 sử dụng OpenSSL:

```
openssl s_client -connect <ip>:995
```

***

## Enumeration

### Thu thập banner

Sử dụng Netcat để lấy thông tin dịch vụ và phiên bản qua banner:

```
nc <ip> 110
```

***

## Attack Vectors

### Đăng nhập với thông tin mặc định

Thử đăng nhập với thông tin đăng nhập mặc định hoặc yếu như `admin`/`admin`:

```
nc <ip> 110
# Sau khi kết nối, nhập:
USER <username>
PASS <password>
```

***

## Post-Exploitation

### Các câu POP3 thông dụng

<table><thead><tr><th width="94">Command</th><th width="385">Description</th><th width="158">Usage</th></tr></thead><tbody><tr><td>USER</td><td>Đăng nhập với "uid"</td><td>USER uid</td></tr><tr><td>PASS</td><td>Nhập password</td><td>PASS password</td></tr><tr><td>STAT</td><td>Liệt kê số lượng thư, tổng kích thước hộp thư</td><td>STAT</td></tr><tr><td>LIST</td><td>Liệt kê các thư và kích thước của chúng</td><td>LIST</td></tr><tr><td>RETR</td><td>Hiển thị thư thứ n</td><td>RETR n</td></tr><tr><td>DELE</td><td>Đánh dấu thư thứ n để xóa</td><td>DELE n</td></tr><tr><td>RSET</td><td>Hoàn tác mọi thay đổi</td><td>RSET</td></tr><tr><td>QUIT</td><td>Đăng xuất</td><td>QUIT</td></tr><tr><td>TOP</td><td>Hiển thị n dòng đầu tiên của thư có số thứ tự msg</td><td>TOP msg n</td></tr><tr><td>CAPA</td><td>Liệt kê các tính năng mà hệ thống hỗ trợ</td><td>CAPA</td></tr></tbody></table>

### Kiểm tra thông tin đăng nhập

Tìm kiếm email chứa cặp tên người dùng/mật khẩu để truy cập thêm tài khoản:

```
RETR <message_number>
```

Kiểm tra nội dung email

### Tìm dữ liệu nhạy cảm

Tìm kiếm dữ liệu nhạy cảm như thông tin cá nhân, tài chính, hoặc bí mật doanh nghiệp trong email:

```
RETR <message_number>
```

Phân tích nội dung email